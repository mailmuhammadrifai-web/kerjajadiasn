<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hasil Simulasi - Kerja Jadi ASN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-20">

    <nav class="bg-white border-b border-slate-100 sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="font-extrabold text-blue-600 text-lg uppercase tracking-tighter">KERJA JADI <span class="text-yellow-500">ASN</span></h1>
            <div class="flex items-center gap-2">
                <span class="text-[10px] font-bold text-slate-400 uppercase">PIN:</span>
                <span id="displayPin" class="text-sm font-bold text-slate-800 tracking-wider">MEMUAT...</span>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 mt-8 max-w-4xl">
        <div class="bg-white rounded-[2.5rem] p-8 shadow-xl shadow-blue-50 border border-slate-100 text-center mb-8 relative overflow-hidden">
            <div class="relative z-10">
                <div id="statusBadge" class="inline-block px-6 py-2 rounded-full font-black text-xs uppercase tracking-[0.2em] mb-4 transition-colors duration-500">
                    Mengevaluasi...
                </div>
                <h2 class="text-slate-400 font-bold uppercase text-xs tracking-widest mb-2">Total Skor Anda</h2>
                <div id="totalSkor" class="text-7xl font-black text-slate-900 mb-6">0</div>
                
                <p id="pesanKelulusan" class="text-slate-500 text-sm max-w-sm mx-auto leading-relaxed">
                    Sedang menarik data dari sesi ujian Anda...
                </p>
            </div>
            <div class="absolute -top-10 -left-10 w-40 h-40 bg-blue-50 rounded-full blur-3xl opacity-50"></div>
        </div>

        <div class="grid md:grid-cols-3 gap-6 mb-10">
            <div class="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm">
                <div class="flex justify-between items-start mb-4">
                    <span class="text-[10px] font-black text-blue-600 uppercase">TWK</span>
                    <span class="text-[10px] font-bold text-slate-400 uppercase">PG: 65</span>
                </div>
                <div id="skorTWK" class="text-3xl font-black text-slate-800 mb-1">0</div>
                <div id="statusTWK" class="text-[10px] font-bold uppercase tracking-wider">Memuat...</div>
            </div>
            <div class="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm">
                <div class="flex justify-between items-start mb-4">
                    <span class="text-[10px] font-black text-blue-600 uppercase">TIU</span>
                    <span class="text-[10px] font-bold text-slate-400 uppercase">PG: 80</span>
                </div>
                <div id="skorTIU" class="text-3xl font-black text-slate-800 mb-1">0</div>
                <div id="statusTIU" class="text-[10px] font-bold uppercase tracking-wider">Memuat...</div>
            </div>
            <div class="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm">
                <div class="flex justify-between items-start mb-4">
                    <span class="text-[10px] font-black text-blue-600 uppercase">TKP</span>
                    <span class="text-[10px] font-bold text-slate-400 uppercase">PG: 166</span>
                </div>
                <div id="skorTKP" class="text-3xl font-black text-slate-800 mb-1">0</div>
                <div id="statusTKP" class="text-[10px] font-bold uppercase tracking-wider">Memuat...</div>
            </div>
        </div>

        <div class="flex flex-col md:flex-row gap-4 justify-center items-center">
            <button onclick="kembaliDashboard()" class="w-full md:w-auto bg-slate-900 text-white px-8 py-4 rounded-2xl font-bold text-sm hover:bg-black transition flex items-center justify-center gap-2 shadow-xl shadow-slate-200 active:scale-95">
                <i class="fa-solid fa-house"></i> Kembali ke Dashboard
            </button>
            <button onclick="window.print()" class="w-full md:w-auto bg-white text-slate-600 px-8 py-4 rounded-2xl font-bold text-sm border border-slate-200 hover:bg-slate-50 transition flex items-center justify-center gap-2 active:scale-95">
                <i class="fa-solid fa-print"></i> Simpan Hasil (PDF)
            </button>
        </div>
    </main>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const pinAkses = urlParams.get('id');
        const PG = { twk: 65, tiu: 80, tkp: 166 };

        function loadRealData() {
            if (!pinAkses) {
                window.location.href = "login.html";
                return;
            }
            document.getElementById('displayPin').innerText = pinAkses;

            const key = `hasil_${pinAkses}`;
            const storedData = localStorage.getItem(key);

            if (!storedData) {
                alert("Data ujian tidak ditemukan.");
                window.location.href = "login.html";
                return;
            }

            const data = JSON.parse(storedData);
            updateUI(data);
        }

        function updateUI(data) {
            document.getElementById('totalSkor').innerText = data.total;
            document.getElementById('skorTWK').innerText = data.twk;
            document.getElementById('skorTIU').innerText = data.tiu;
            document.getElementById('skorTKP').innerText = data.tkp;

            const lulusTWK = data.twk >= PG.twk;
            const lulusTIU = data.tiu >= PG.tiu;
            const lulusTKP = data.tkp >= PG.tkp;

            updateStatusLabel('statusTWK', lulusTWK);
            updateStatusLabel('statusTIU', lulusTIU);
            updateStatusLabel('statusTKP', lulusTKP);

            const statusBadge = document.getElementById('statusBadge');
            const pesan = document.getElementById('pesanKelulusan');

            if (lulusTWK && lulusTIU && lulusTKP) {
                statusBadge.innerText = "LULUS PASSING GRADE";
                statusBadge.classList.add("bg-green-100", "text-green-700");
                pesan.innerHTML = "Selamat! Anda berhasil melampaui ambang batas. Pertahankan performa ini!";
            } else {
                statusBadge.innerText = "TIDAK LULUS PASSING GRADE";
                statusBadge.classList.add("bg-red-100", "text-red-700");
                pesan.innerHTML = "Jangan menyerah! Anda belum mencapai ambang batas di materi tertentu.";
            }
        }

        function updateStatusLabel(id, isLulus) {
            const el = document.getElementById(id);
            if(isLulus) {
                el.innerText = "LULUS PG";
                el.className = "text-[10px] font-bold uppercase tracking-wider text-green-600";
            } else {
                el.innerText = "GAGAL PG";
                el.className = "text-[10px] font-bold uppercase tracking-wider text-red-600";
            }
        }

        // --- LOGIKA NAVIGASI PAKET PESERTA ---
        function kembaliDashboard() {
            // Mengambil tipe paket peserta yang disimpan saat login/di dashboard
            // Jika tidak ditemukan, default ke '1'
            const tipePaketUser = localStorage.getItem(`paket_peserta_${pinAkses}`) || "1";
            
            // Redirect sesuai paket user
            window.location.href = `dashboardpaket${tipePaketUser}.html?id=${pinAkses}`;
        }

        window.onload = loadRealData;
    </script>
</body>
</html>
